---
title: サポートされるファイルの種類-Microsoft Information Protection SDK
description: サポートされているファイルの種類、ファイル名拡張子、および Microsoft Information Protection ソフトウェア開発キットを担当する管理者の保護レベルに関する技術的な詳細。
author: msmbaldwin
ms.author: mbaldwin
ms.date: 08/16/2020
ms.topic: conceptual
ms.service: information-protection
ms.openlocfilehash: e247a31b364c40f270538d73815464491fca7647
ms.sourcegitcommit: 8e48016754e6bc6d051138b3e3e3e3edbff56ba5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/04/2021
ms.locfileid: "97864857"
---
# <a name="file-types-supported-by-the-microsoft-information-protection-sdk"></a>Microsoft Information Protection SDK でサポートされるファイルの種類

Microsoft Information Protection SDK では、ドキュメントと電子メールに次のものを適用できます。

- 分類のみ

- 分類と保護

- 保護のみ

Microsoft Information Protection SDK では、よく知られている機密情報の種類や、ユーザーが定義した正規表現を使用して、一部のファイルの種類の内容を検査することもできます。

Microsoft Information Protection SDK でサポートされているファイルの種類を確認し、さまざまな保護レベルを理解し、既定の保護レベルを変更し、分類と保護から自動的に除外 (スキップ) されるファイルを特定するには、次の情報を使用します。

## <a name="file-types-supported-for-classification-only"></a>分類のみにサポートされているファイルの種類

次のファイルの種類は、保護されていない場合でも分類することができます。

- **Adobe Portable Document Format**: .pdf

- **Microsoft Project**: .mpp、.mpt

- **Microsoft Publisher**: .pub

- **Microsoft XPS**: .xps、.oxps

- **イメージ**: .jpg、.jpe、.jpeg、.jif、.jfif、.jfi、 .png、.tif、.tiff

- **Autodesk Design Review 2013**: .dwfx

- **Adobe Photoshop**: .psd

- **Digital Negative**: .dng

- **Microsoft Office**: 次の表に示すファイルの種類。

    これらのファイルの種類に対してサポートされるファイル形式は、次の Office プログラム用の 97-2003 ファイル形式と Office Open XML 形式です: Word、Excel、PowerPoint。

    | Office ファイルの種類                                                                                                                                                                                                                                               | Office ファイルの種類                                                                                                                                                                                                                                 |
    | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
    | .doc<br /><br />.docm<br /><br />.docx<br /><br />.dot<br /><br />.dotm<br /><br />.dotx<br /><br />.potm<br /><br />.potx<br /><br />.pps<br /><br />.ppsm<br /><br />.ppsx<br /><br />.ppt<br /><br />.pptm<br /><br />.pptx<br /><br />.vdw<br /><br />.vsd | .vsdm<br /><br /> .vsdx<br /><br />.vss<br /><br />.vssm<br /><br />.vst<br /><br />.vstm<br /><br />.vssx<br /><br />.vstx<br /><br />.xls<br /><br />.xlsb<br /><br />.xlt<br /><br />.xlsm<br /><br />.xlsx<br /><br />.xltm<br /><br />.xltx |

他のファイルの種類では、保護されている場合に分類がサポートされます。 これらのファイルの種類については、下記の「[分類と保護がサポートされているファイルの種類](#supported-file-types-for-classification-and-protection)」を参照してください。

たとえば、 **全般** ラベルが分類を適用し、保護を適用しない場合、sales.pdf という名前のファイルに **全般** ラベルを適用できますが、このラベルを sales.txt という名前のファイルに適用することはできません。

また、 **社外秘 \ すべての従業員** に分類と保護が適用されている場合は、このラベルを sales.pdf という名前のファイルと sales.txt という名前のファイルに適用できます。 また、保護のみをこれらのファイルに適用し、分類は対象外とすることも可能です。

## <a name="file-types-supported-for-protection"></a>保護がサポートされているファイルの種類

Microsoft Information Protection SDK では、次の表に示すように、2つの異なるレベルでの保護がサポートされています。

| 保護の種類     | ネイティブ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | ジェネリック                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 説明            | テキスト、イメージ、Microsoft Office (Word、Excel、PowerPoint) ファイル、.pdf ファイル、および Rights Management サービスをサポートする他のアプリケーションのファイルの種類については、ネイティブ保護で、暗号化と権限の適用 (アクセス許可) の両方を含む強力なレベルの保護が提供されます。                                                                                                                                                                                                                                                                                       | 他のすべてのアプリケーションとファイルの種類では、.pfile ファイルの種類を使用したファイルのカプセル化と、ユーザーがファイルを開くことを許可されているかどうかの検証を含む、一般的な保護が提供されます。                                                                                                                                                                                                                                                                                              |
| 保護             | ファイルの保護は次の方法で適用されます。<br /><br />- 保護されたコンテンツが表示される前に、電子メールでファイルを受け取るユーザー、あるいはファイルや共有のアクセス許可によってそれに対するアクセス権が付与されるユーザーについて、認証が正しく行われる必要があります。<br /><br />- さらに、ファイルが保護されたときにコンテンツの所有者によって設定された使用権限およびポリシーは、コンテンツが Azure Information Protection ビューアーで表示される (保護されたテキストとイメージ ファイルの場合) か、関連付けられたアプリケーションで表示される (他のサポートされているすべてのファイルの種類の場合) ときに適用されます。 | ファイルの保護は次の方法で適用されます。<br /><br />- 保護されたコンテンツが表示される前に、ファイルを開く権限があり、それに対するアクセス権が付与されるユーザーについて、認証が正しく行われる必要があります。 認証が失敗した場合、ファイルは開きません。<br /><br />- コンテンツの所有者によって設定された使用権限とポリシーが表示され、目的の使用ポリシーが承認済みユーザーに通知されます。<br /><br />- 承認済みユーザーがファイルを開きアクセスしていることを確認する監査ログが実行されます。 ただし、使用権限は適用されません。 |
| ファイルの種類ごとの既定値 | これは、次のファイルの種類の既定の保護レベルです。<br /><br />- テキストとイメージ ファイル<br /><br />- Microsoft Office (Word、Excel、PowerPoint) ファイル<br /><br />- Portable Document Format (.pdf)<br /><br />詳細については、下記の「[分類と保護がサポートされているファイルの種類](#supported-file-types-for-classification-and-protection)」 を参照してください。                                                                                                                                                                              | これは、ネイティブな保護によってサポートされない他のすべてのファイルの種類 (.vsdx、.rtf など) の既定の保護です。                                                                                                                                                                                                                                                                                                                                                                                             |

Microsoft Information Protection SDK によって適用される既定の保護レベルを変更できます。 既定のレベルをネイティブからジェネリックに、ジェネリックからネイティブに変更することができます。また、Microsoft Information Protection SDK で保護を適用しないようにすることもできます。

### <a name="file-sizes-supported-for-protection"></a>保護がサポートされているファイルのサイズ

Microsoft Information Protection SDK 1.6 以降では、既定のファイルサイズの最大値は 6 GB です。 この設定は、必要に応じてオーバーライドできます。 レガシ Office プラットフォームの既定値よりも低い既定値が適用されます。


- **Office ファイル:**

  | Office アプリケーション                                                                                                          | サポートされる最大ファイル サイズ                                                                                                |
  | --------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
  | Word 2007 (AD RMS のみでサポート)<br /><br />Word 2010<br /><br />Word 2013<br /><br />Word 2016                         | 32 ビット: 512 MB<br /><br />64 ビット: 512 MB                                                                                   |
  | Excel 2007 (AD RMS のみでサポート)<br /><br />Excel 2010<br /><br />Excel 2013<br /><br />Excel 2016                     | 32 ビット: 2 GB<br /><br />64 ビット: 使用可能なディスク領域とメモリによってのみ制限されます                                            |
  | PowerPoint 2007 (AD RMS のみでサポート)<br /><br />PowerPoint 2010<br /><br />PowerPoint 2013<br /><br />PowerPoint 2016 | 32 ビット: 使用可能なディスク領域とメモリによってのみ制限されます<br /><br />64 ビット: 使用可能なディスク領域とメモリによってのみ制限されます |

- **その他のすべてのファイル**:

    その他のファイルの種類を保護し、SDK を使用してこれらのファイルの種類の保護を削除するには: 最大ファイルサイズは、使用可能なディスク領域とメモリによってのみ制限されます。

### <a name="supported-file-types-for-classification-and-protection"></a>分類と保護がサポートされているファイルの種類

次の表は、Microsoft Information Protection SDK によるネイティブ保護をサポートするファイルの種類のサブセットを示しています。これは分類することもできます。

これらの種類のファイルは、ネイティブに保護されると、元のファイルの拡張子が変更され読み取り専用になるため、別々に識別されます。 一般的に保護されるファイルの場合、元のファイル名拡張子が常に .pfile に変わる点に注意してください。

> [!WARNING]
> ファイル名拡張子に基づいて検査とアクションを実行するファイアウォール、Web プロキシ、またはセキュリティ ソフトウェアがある場合は、新しいファイル名拡張子をサポートするように、これらのネットワーク デバイスとソフトウェアの再構成が必要になる場合があります。

| 元のファイル名拡張子 | 保護されるファイル名拡張子 |
| ---------------------------- | ----------------------------- |
| .txt                         | .ptxt                         |
| .xml                         | .pxml                         |
| .jpg                         | .pjpg                         |
| .jpeg                        | .pjpeg                        |
| .pdf                         | .ppdf [[1]](#footnote-1)      |
| .png                         | .ppng                         |
| .tif                         | .ptif                         |
| .tiff                        | .ptiff                        |
| .bmp                         | .pbmp                         |
| .gif                         | .pgif                         |
| .jpe                         | .pjpe                         |
| .jfif                        | .pjfif                        |

###### <a name="footnote-1"></a>脚注 1
最新バージョンの Microsoft Information Protection SDK では、保護された PDF ドキュメントのファイル名拡張子は .pdf のままです。

次の表に、Microsoft Information Protection SDK によるネイティブ保護をサポートするその他のファイルの種類を示します。このファイルの種類は分類することもできます。 これらは、Microsoft Office アプリのファイルの種類であることがわかります。 これらのファイルの種類に対してサポートされるファイル形式は、次の Office プログラム用の 97-2003 ファイル形式と Office Open XML 形式です: Word、Excel、PowerPoint。

これらのファイルの場合、ファイル名拡張子は、ファイルが Rights Management サービスで保護された後も変更されません。

| Office でサポートされるファイルの種類                                                                                                                                                                                                                  | Office でサポートされるファイルの種類                                                                                                                                                                                                                  |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| .doc<br /><br />.docm<br /><br />.docx<br /><br />.dot<br /><br />.dotm<br /><br />.dotx<br /><br />.potm<br /><br />.potx<br /><br />.pps<br /><br />.ppsm<br /><br />.ppsx<br /><br />.ppt<br /><br />.pptm<br /><br />.pptx<br /><br />.vsdm | .vsdx<br /><br />.vssm<br /><br />.vssx<br /><br />.vstm<br /><br />.vstx<br /><br />.xla<br /><br />.xlam<br /><br />.xls<br /><br />.xlsb<br /><br />.xlt<br /><br />.xlsm<br /><br />.xlsx<br /><br />.xltm<br /><br />.xltx<br /><br />.xps |

### <a name="limitations-for-container-files-such-as-zip-msg-files"></a>.Zip、.msg ファイルなどのコンテナーファイルの制限事項

コンテナー ファイルは、その他のファイルが含まれるファイルです。典型的な例は、圧縮ファイルが含まれる .zip ファイルです。 その他の例としては、rar、7z、.msg ファイル、rpq msg ファイル、添付ファイルを含む PDF ドキュメントなどがあります。

これらのコンテナー ファイルを分類し、保護できますが、分類と保護はコンテナー内の各ファイルに適用されません。 同様に、保護されたコンテナーファイルは SDK を使用して保護を解除できますが、コンテナー内のファイルに対する保護 (適用されている場合) は、コンテナーファイルでの保護の削除操作によって再帰的に削除されることはありません。 アプリケーション開発者は、コンテナー内のすべてのファイルの recursing と復号化を担当します。

分類され、保護されているファイルがコンテナー ファイル内にある場合、先にファイルを抽出し、分類または保護設定を変更する必要があります。
