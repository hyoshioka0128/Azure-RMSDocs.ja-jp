---
title: 使用制限について | Azure RMS
description: すべての RMS 対応アプリケーションは、使用制限を適用する必要があります。
keywords: ''
author: lleonard-msft
ms.author: alleonar
manager: mbaldwin
ms.date: 02/23/2017
ms.topic: conceptual
ms.service: information-protection
ms.assetid: E388B16C-ECDA-4696-A040-D457D3C96766
audience: developer
ms.reviewer: shubhamp
ms.suite: ems
ms.openlocfilehash: b53c36a6ddd0d726e21f9870ec040337b5b0f335
ms.sourcegitcommit: 26a2c1becdf3e3145dc1168f5ea8492f2e1ff2f3
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/07/2018
ms.locfileid: "44151454"
---
# <a name="understanding-usage-restrictions"></a>Understanding usage restrictions (使用制限について)

すべての RMS 対応アプリケーションは、使用制限を適用する必要があります。 使用制限とは、ユーザーが操作 (例: ドキュメントの印刷) を実行しようとしたが、 その操作を実行するための権限 (例: 印刷権限) がドキュメントの RMS ポリシーによって付与されていない 状態です。

ドキュメントに対するユーザーのアクセス許可は、[IpcAccessCheck](https://msdn.microsoft.com/library/hh535253.aspx) 機能を使用して照会できます。

## <a name="designing-with-usage-restrictions"></a>使用制限を含む設計

-   標準の RMS 権限について理解する

    アプリケーションに適用できるすべての RMS 権限については、「[Usage restriction reference (使用制限のリファレンス)](#usage-restriction-reference)」を参照してください。

    アプリケーションで定義される権限は状況に固有のもので、それを超える場合は標準の RMS 権限が作成されることがあります。

-   使用制限の強制ポイントを特定する

    *使用制限の強制ポイント*とは、アプリケーションの制御フロー内で使用制限を強制する必要がある場所です。 「[Usage restriction reference (使用制限のリファレンス)](#usage-restriction-reference)」のトピックに、一般的な強制ポイントの例がいくつか紹介されています。

    独自のアプリケーションを評価して、どの使用制限の強制ポイントを適用するかを判断します。

    「[Usage restriction reference (使用制限のリファレンス)](#usage-restriction-reference)」で説明されているすべての強制ポイントが必要なわけではありません。 たとえば、アプリケーションがコンテンツの印刷をユーザーに許可していない場合は、**IPC\_GENERIC\_PRINT** 権限についてチェックする必要はありません。

-   各強制ポイントでアクセス権のチェックを実行するように、コードを更新します。

    特定の権限の適用方法については、「[Usage restriction reference (使用制限のリファレンス)](#usage-restriction-reference)」を参照してください。

## <a name="usage-restriction-reference"></a>使用制限のリファレンス

使用制限は、次の定数で定義されます。

「AD RMS の権限」列に記載されている各ユーザーの権限には、それぞれ説明、適用ポイント、および推奨される適用方法が示されています。

| AD RMS 権限/説明 | 適用方法 |
|--------------------------|----------------|
|**IPC_GENERIC_ALL** <br><br> ユーザーにすべての権限を付与します。 <br><br> **一般的な適用ポイント**: なし |この権限はシステムで使用され、通常は直接確認することができません。 <br><br> 次の例に示すように、[IpcAccessCheck](https://msdn.microsoft.com/library/hh535253.aspx) では、この権限を使用して、その他の権限をユーザーに付与するかどうかを決定します。<br><br> `/* fAccessGranted is set to TRUE if either the IPC_GENERIC_WRITE or the IPC_GENERIC_ALL right is granted */` <br><br> `IpcAccessCheck(hKey, IPC_GENERIC_WRITE, &fAccessGranted);`|
|**IPC_GENERIC_READ** <br><br> ドキュメントの内容を読み取る権限。 <br><br> **一般的な適用ポイント**: ドキュメントの読み込み|ドキュメントの内容の読み込みまたは表示を行いません。|
|**IPC_GENERIC_WRITE** <br><br> ドキュメントの内容を編集する権限。 <br><br> **一般的な適用ポイント**: ドキュメントの変更|ドキュメントの内容を変更するために使用できる UI コントロールを編集不可にします。 <br><br> ドキュメントの変更をトリガーするメニュー項目を無効にします。 典型的な例としては、**[編集]** > **[切り取り]**、**[編集]** > **[貼り付け]**、**[挿入]** があります。 <br><br>ドキュメントの変更をトリガーするショートカット メニュー項目を無効にします。|
|AD RMS の権限なし <br><br> 説明なし <br><br> **一般的な適用ポイント**: 保存 | **[ファイル]** > **[保存]** メニューを無効にします。 <br><br> **注** この権限は元のドキュメントに対する変更を表さないため、**[ファイル]** > **[名前を付けて保存]** を制御しません。<br><br> 保存をトリガーするために使用できるキーボード ショートカット (Ctrl + S など) を無効にします。<br><br> **ヒント** ユーザーがこの権限を持っていない場合に失敗するように、**[ファイル]** > **[保存]** の主要なコードを更新することをお勧めします。 これは、保存をトリガーするために使用できる UX メカニズムがない場合の安全策として機能します。 |
|**IPC_GENERIC_EXTRACT** <br><br> 保護された形式からコンテンツを抽出し、保護されていない形式にする権限。 <br><br> **一般的な適用ポイント**: クリップボードへのコピー | **[編集]** > **[コピー]** メニューを無効にします。 **[編集]** > **[切り取り]** メニューを無効にします。 <br><br>ショートカット メニューの **[コピー]** と **[切り取り]** を無効にします。<br><br>コピーをトリガーするために使用できるキーボード ショートカット (Ctrl + C、Ctrl + X など) を無効にします。<br><br>ユーザーがこの権限を持っていない場合は、データのコピーを拒否するように [**WM_CUT**](https://msdn.microsoft.com/library/ms649023) のウィンドウ メッセージ ハンドラーを更新します。 Windows が提供する既定のメッセージ ハンドラーをウィンドウで使用する場合は、このウィンドウをサブクラス化して、**WM_COPY** と **WM_CUT** の独自のハンドラーを指定します。 |
|AD RMS の権限なし <br><br> 説明なし <br><br> **一般的な適用ポイント**: 名前を付けて保存 |**[名前を付けて保存]** ダイアログ ボックスで、RMS 保護なしでドキュメントを保存するファイル形式を無効にします。|
|AD RMS の権限なし <br><br> 説明なし <br><br> **一般的な適用ポイント**: Alt + PrintScreen|ドキュメントの内容を表示するウィンドウで [IpcProtectWindow](https://msdn.microsoft.com/library/hh535268.aspx) を呼び出します。|
|**IPC_GENERIC_EXPORT** <br><br> 保護された形式からコンテンツを抽出し、AD RMS で保護される別の形式にする権限。 <br><br> **一般的な適用ポイント**: 名前を付けて保存|**[名前を付けて保存]** ダイアログ ボックスで、他のファイル形式として保存する機能を無効にします。<br><br>**ヒント** ユーザーがこのファイルを別の形式として保存しようとした場合、およびユーザーがこの権限を持っていない場合に失敗するように、**[ファイル]** > **[名前を付けて保存]** の主要なコードを更新することをお勧めします。 これは、名前を付けて保存をトリガーするために使用できる UX メカニズムがない場合の安全策として機能します。|
|**IPC_GENERIC_PRINT** <br><br> ドキュメントの内容を印刷する権限。 <br><br> **一般的な適用ポイント**: 印刷|**[ファイル]** > **[印刷]** メニューを無効にします。<br><br>印刷をトリガーするために使用できるキーボード ショートカット (Ctrl + P など) を無効にします。<br><br>印刷をトリガーするために使用できるショートカット メニュー項目を無効にします。<br><br>**ヒント** ユーザーがこの権限を持っていない場合に失敗するように、**[ファイル]** > **[印刷]** の主要なコードを更新することをお勧めします。 これは、印刷をトリガーするために使用できる UX メカニズムがない場合の安全策として機能します。|
|**IPC_GENERIC_COMMENT** <br><br> 一部のアプリケーションでは、主要なドキュメントの内容を更新せずに、ドキュメントにコメントや注釈を追加する機能がサポートされています。<br><br>この権限は、この機能に対するユーザー アクセスを許可します。 <br><br> **一般的な適用ポイント**: <br><br> [校閲] > [コメントの挿入] <br><br> [校閲] > [コメントの削除] | ドキュメントのコメントまたは注釈を変更するために使用できるメニュー項目を無効にします。 例として、**[校閲]** > **[コメントの挿入]** や **[校閲]** > **[コメントの削除]** などがあります。 <br><br>ドキュメントのコメントの変更をトリガーできるキーボード ショートカットを無効にします。<br><br>**注** 既定の実装では、新しいコメントをファイルに保持するために **IPC_GENERIC_COMMENT** と **IPC_GENERIC_WRITE** の両方が必要です。 アプリケーションでは、**IPC_GENERIC_COMMENT** 権限が付与され、**IPC_GENERIC_WRITE** 権限が付与されない場合にサポートを追加できます。 この場合、ドキュメントの変更がコメントだけに制限されていれば、保存が許可されます。|
|**IPC_VIEW_RIGHTS** <br><br> 説明なし <br><br> **一般的な適用ポイント**: N/A|システムにより適用されます。 この権限が付与されている場合を除き、システムは開発者によるライセンスからの[**ユーザー権限の一覧**](https://msdn.microsoft.com/library/hh535286.aspx)のクエリを許可しません。
|**IPC_EDIT_RIGHTS** <br><br> 一部のアプリケーションでは、AD RMS で保護されたコンテンツのユーザーと権限のセットをユーザーが変更できます。<br><br>この権限は、この機能に対するユーザー アクセスを許可します。 <br><br> **一般的な適用ポイント**: UI コントロールを編集するアプリケーション権限|ドキュメントの RMS ポリシーを編集するために使用できる UI へのユーザー アクセスを無効にします。|


## <a name="related-topics"></a>関連トピック

* [IpcAccessCheck](https://msdn.microsoft.com/library/hh535253.aspx)
